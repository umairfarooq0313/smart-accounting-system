<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobile App - Digital Ledger</title>
    <!-- Bootstrap CSS (place bootstrap.min.css in /css folder) -->
    <link href="bootstrap.min.css" rel="stylesheet">
    <!-- Chart.js (place Chart.min.js in /js folder) -->
    <script src="chart.js"></script>
    <style>
        /* SVG icon styles */
        .bi {
            width: 1em;
            height: 1em;
            vertical-align: -0.125em;
            fill: currentColor;
        }
        
        .icon {
            width: 20px;
            height: 20px;
            margin-right: 5px;
            vertical-align: text-top;
        }
        
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding-bottom: 20px;
        }
        
        .dashboard-header {
            background: linear-gradient(135deg, #4b6cb7 0%, #182848 100%);
            color: white;
            border-radius: 0 0 10px 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .card {
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            margin-bottom: 20px;
            border: none;
        }
        
        .summary-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }
        
        .btn-primary {
            background-color: #4b6cb7;
            border-color: #4b6cb7;
        }
        
        .btn-danger {
            background-color: #e74c3c;
            border-color: #e74c3c;
        }
        
        .btn-success {
            background-color: #2ecc71;
            border-color: #2ecc71;
        }
        
        .btn-warning {
            background-color: #f39c12;
            border-color: #f39c12;
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        
        .table-container {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .remove-btn {
            cursor: pointer;
            transition: transform 0.2s;
            padding: 0.25rem 0.5rem;
        }
        
        .remove-btn:hover {
            transform: scale(1.1);
        }
        
        .product-badge {
            font-size: 0.75rem;
            padding: 0.25em 0.4em;
            margin-left: 5px;
        }
        
        .empty-state {
            text-align: center;
            padding: 3rem;
            color: #6c757d;
        }
        
        .empty-state .emoji {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        
        .floating-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: #4b6cb7;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 4px 20px rgba(75, 108, 183, 0.3);
            z-index: 1000;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            outline: none;
        }
        
        .floating-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 24px rgba(75, 108, 183, 0.4);
            background-color: #3a5a9e;
        }
        
        .border-start-primary {
            border-left: 4px solid #4b6cb7 !important;
        }
        
        .border-start-success {
            border-left: 4px solid #2ecc71 !important;
        }
        
        .border-start-danger {
            border-left: 4px solid #e74c3c !important;
        }
        
        .bg-primary-light {
            background-color: rgba(75, 108, 183, 0.1) !important;
        }
        
        .bg-success-light {
            background-color: rgba(46, 204, 113, 0.1) !important;
        }
        
        .bg-danger-light {
            background-color: rgba(231, 76, 60, 0.1) !important;
        }
        
        .input-group-unit {
            min-width: 300px;
        }
        
        .alert-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1100;
            min-width: 300px;
        }
        
        /* Chart tooltip styling */
        .chartjs-tooltip {
            opacity: 1 !important;
            background: rgba(0, 0, 0, 0.7) !important;
            border-radius: 4px !important;
            padding: 8px !important;
            color: white !important;
            pointer-events: none !important;
        }
        
        @media (max-width: 768px) {
            .input-group-unit {
                width: 40%;
            }
            
            .chart-container {
                height: 250px;
            }
        }
        
        .navbar-brand {
            padding-top: 0.2rem;
            padding-bottom: 0.2rem;
        } 
        
        .navbar {
            min-height: 140px; /* Adjust this value to your preferred height */
        }
    </style>
</head>
<body>
    <!-- SVG Icons Definitions -->
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
        <!-- Plus Circle -->
        <symbol id="bi-plus-circle" viewBox="0 0 16 16">
            <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
            <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
        </symbol>
        
        <!-- Save -->
        <symbol id="bi-save" viewBox="0 0 16 16">
            <path d="M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H9.5a1 1 0 0 0-1 1v7.293l2.646-2.647a.5.5 0 0 1 .708.708l-3.5 3.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L7.5 9.293V2a2 2 0 0 1 2-2H14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h2.5a.5.5 0 0 1 0 1H2z"/>
        </symbol>
        
        <!-- Trash -->
        <symbol id="bi-trash" viewBox="0 0 16 16">
            <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
            <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4L4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
        </symbol>
        
        <!-- List -->
        <symbol id="bi-list" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"/>
        </symbol>
        
        <!-- Plus (for floating button) -->
        <symbol id="bi-plus" viewBox="0 0 16 16">
            <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
        </symbol>
        
        <!-- Bar Chart -->
        <symbol id="bi-bar-chart" viewBox="0 0 16 16">
            <path d="M4 11H2v3h2v-3zm5-4H7v7h2V7zm5-5h-2v12h2V2zm-2-1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1h-2zM6 7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7zm-5 4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1v-3z"/>
        </symbol>
        
        <!-- Pie Chart -->
        <symbol id="bi-pie-chart" viewBox="0 0 16 16">
            <path d="M7.5 1.018a7 7 0 0 0-4.79 11.566L7.5 7.793V1.018zm1 0V7.5h6.482A7.001 7.001 0 0 0 8.5 1.018zM14.982 8.5H8.207l-4.79 4.79A7 7 0 0 0 14.982 8.5zM0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8z"/>
        </symbol>
        
        <!-- Graph Up -->
        <symbol id="bi-graph-up" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M0 0h1v15h15v1H0V0zm10 3.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V4.9l-3.613 4.417a.5.5 0 0 1-.74.037L7.06 6.767l-3.656 5.027a.5.5 0 0 1-.808-.588l4-5.5a.5.5 0 0 1 .758-.06l2.609 2.61L13.445 4H10.5a.5.5 0 0 1-.5-.5z"/>
        </symbol>
        
        <!-- Table -->
        <symbol id="bi-table" viewBox="0 0 16 16">
            <path d="M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm15 2h-4v3h4V4zm0 4h-4v3h4V8zm0 4h-4v3h3a1 1 0 0 0 1-1v-2zm-5 3v-3H6v3h4zm-5 0v-3H1v2a1 1 0 0 0 1 1h3zm-4-4h4V8H1v3zm0-4h4V4H1v3zm5-3v3h4V4H6zm4 4H6v3h4V8z"/>
        </symbol>
        
        <!-- Currency Exchange -->
        <symbol id="bi-currency-exchange" viewBox="0 0 16 16">
            <path d="M0 5a5.002 5.002 0 0 0 4.027 4.905 6.46 6.46 0 0 1 .544-2.073C3.695 7.536 3.132 6.864 3 5.91h-.5v-.426h.466V5.05c0-.046 0-.093.004-.135H2.5v-.427h.511C3.236 3.24 4.213 2.5 5.681 2.5c.316 0 .59.031.819.085v.733a3.46 3.46 0 0 0-.815-.082c-.919 0-1.538.466-1.734 1.252h1.917v.427h-1.98c-.003.046-.003.097-.003.147v.422h1.983v.427H3.93c.118.602.468 1.03 1.005 1.229a6.5 6.5 0 0 1 4.97-3.113A5.002 5.002 0 0 0 0 5zm16 5.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0zm-7.75 1.322c.069.835.746 1.485 1.964 1.562V14h.54v-.62c1.259-.086 1.996-.74 1.996-1.69 0-.865-.563-1.31-1.57-1.54l-.426-.1V8.374c.54.06.884.347.966.745h.948c-.07-.804-.779-1.433-1.914-1.502V7h-.54v.629c-1.076.103-1.808.732-1.808 1.622 0 .787.544 1.288 1.45 1.493l.358.085v1.78c-.554-.08-.92-.376-1.003-.787H8.25zm1.96-1.895c-.532-.12-.82-.364-.82-.732 0-.41.311-.719.824-.809v1.54h-.005zm.622 1.044c.645.145.943.38.943.796 0 .474-.37.8-1.02.86v-1.674l.077.018z"/>
        </symbol>
        
        <!-- Cart Check -->
        <symbol id="bi-cart-check" viewBox="0 0 16 16">
            <path d="M11.354 6.354a.5.5 0 0 0-.708-.708L8 8.293 6.854 7.146a.5.5 0 1 0-.708.708l1.5 1.5a.5.5 0 0 0 .708 0l3-3z"/>
            <path d="M.5 1a.5.5 0 0 0 0 1h1.11l.401 1.607 1.498 7.985A.5.5 0 0 0 4 12h1a2 2 0 1 0 0 4 2 2 0 0 0 0-4h7a2 2 0 1 0 0 4 2 2 0 0 0 0-4h1a.5.5 0 0 0 .491-.408l1.5-8A.5.5 0 0 0 14.5 3H2.89l-.405-1.621A.5.5 0 0 0 2 1H.5zm3.915 10L3.102 4h10.796l-1.313 7h-8.17zM6 14a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm7 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
        </symbol>
        
        <!-- Currency Rupee -->
        <symbol id="bi-currency-rupee" viewBox="0 0 16 16">
            <path d="M4 3.06h2.726c1.22 0 2.12.575 2.325 1.724H4v1.051h5.051C8.855 7.001 8 7.558 6.788 7.558H4v1.317L8.437 14h2.11L6.095 8.884h.855c2.316-.018 3.465-1.476 3.688-3.049H12V4.784h-1.345c-.08-.778-.357-1.335-.793-1.732H12V2H4v1.06z"/>
        </symbol>
        
        <!-- Bag -->
        <symbol id="bi-bag" viewBox="0 0 16 16">
            <path d="M8 1a2.5 2.5 0 0 1 2.5 2.5V4h-5v-.5A2.5 2.5 0 0 1 8 1zm3.5 3v-.5a3.5 3.5 0 1 0-7 0V4H1v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V4h-3.5zM2 5h12v9a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V5z"/>
        </symbol>
        
        <!-- Box Seam -->
        <symbol id="bi-box-seam" viewBox="0 0 16 16">
            <path d="M8.186 1.113a.5.5 0 0 0-.372 0L1.846 3.5l2.404.961L10.404 2l-2.218-.887zm3.564 1.426L5.596 5 8 5.961 14.154 3.5l-2.404-.961zm3.25 1.7l-6.5 2.6v7.922l6.5-2.6V4.24zM7.5 14.762V6.838L1 4.239v7.923l6.5 2.6zM7.443.184a1.5 1.5 0 0 1 1.114 0l7.129 2.852A.5.5 0 0 1 16 3.5v8.662a1 1 0 0 1-.629.928l-7.185 2.874a.5.5 0 0 1-.372 0L.63 13.09a1 1 0 0 1-.63-.928V3.5a.5.5 0 0 1 .314-.464L7.443.184z"/>
        </symbol>
        
        <!-- Check Circle -->
        <symbol id="bi-check-circle" viewBox="0 0 16 16">
            <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
            <path d="M10.97 4.97a.75.75 0 0 1 1.071 1.05l-3.992 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.235.235 0 0 1 .02-.022z"/>
        </symbol>
        
        <!-- Exclamation Triangle -->
        <symbol id="bi-exclamation-triangle" viewBox="0 0 16 16">
            <path d="M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.146.146 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.163.163 0 0 1-.054.06.116.116 0 0 1-.066.017H1.146a.115.115 0 0 1-.066-.017.163.163 0 0 1-.054-.06.176.176 0 0 1 .002-.183L7.884 2.073a.147.147 0 0 1 .054-.057zm1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566z"/>
            <path d="M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995z"/>
        </symbol>
        
        <!-- Exclamation Circle -->
        <symbol id="bi-exclamation-circle" viewBox="0 0 16 16">
            <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
            <path d="M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z"/>
        </symbol>
        
        <!-- Info Circle -->
        <symbol id="bi-info-circle" viewBox="0 0 16 16">
            <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
            <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/>
        </symbol>
    </svg>

    <!-- Navigation Bar -->
<nav class="navbar navbar-expand-lg navbar-dark sticky-top py-1" style="background: linear-gradient(135deg, #4b6cb7 0%, #182848 100%);">
    <div class="container">
        <a class="navbar-brand py-0">
            <h3 class="mb-1">Smart Accounting System</h3>
            <h3 class="mb-0" style="font-size: 0.9em;">(For Business Management)</h3><br>
            <p class="mb-0" style="text-align: left; font-size: 0.6em; color: white;">Developed by: Umair Farooq</p>
        </a>
    </div>
</nav>

    <!-- Alert Section -->
    <div id="alertSection" class="alert-container"></div>

    <div class="container-fluid mt-4">
        <div class="row">
            <!-- Input Form Column -->
            <div class="col-lg-4">
                <div class="card">
                    <div class="card-header bg-white d-flex justify-content-between align-items-center">
                        <h5 class="card-title mb-0">
                            <svg class="icon bi"><use xlink:href="#bi-plus-circle"/></svg>
                            Add New Record
                        </h5>
                        <button id="closeFormBtn" class="btn-close"></button>
                    </div>
                    <div class="card-body">
                        <form id="recordForm">
                            <div class="mb-3">
                                <label for="date" class="form-label">Select date ▼</label>
                                <input type="date" class="form-control" id="date" required>
                            </div>
                            <div class="mb-3">
                                <label for="itemName" class="form-label">Enter item name ▼</label>
                                <input type="text" class="form-control" id="itemName" placeholder="e.g., Sugar, Rice, etc." required>
                            </div>
                            <div class="mb-3">
                                <label for="quantity" class="form-label">Enter quantity ▼</label>
                                <input type="number" class="form-control" id="quantity" placeholder="e.g., 5" min="0.01" step="0.01" required>
                            </div>
                            <div class="mb-3">
                                <label for="unit" class="form-label">Select unit ▼</label>
                                <select class="form-select input-group-unit" id="unit">
                                    <option value="Pound">Pound</option>
                                    <option value="Kg">Kg</option>
                                    <option value="Gram">Gram</option>
                                    <option value="Maund">Maund</option>
                                    <option value="Ton">Ton</option>
                                    <option value="Liter">Liter</option>
                                    <option value="Gallon">Gallon</option>                                    
                                    <option value="Milliliter">Milliliter</option>
                                    <option value="Meter">Meter</option>
                                    <option value="Foot">Foot</option>
                                    <option value="Pair">Pair</option>
                                    <option value="Yard">Yard</option>
                                    <option value="Packet">Packet</option>
                                    <option value="Box">Box</option>
                                    <option value="Bucket">Bucket</option>
                                    <option value="Bottle">Bottle</option>
                                    <option value="Bag">Bag</option>
                                    <option value="Piece">Piece</option>
                                    <option value="Dozen">Dozen</option>
                                    <option value="Ounce">Ounce</option>
                                    <option value="Tola">Tola</option>
                                    <option value="Bundle">Bundle</option>
                                    <option value="Sack">Sack</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="unitPrice" class="form-label">Enter selling price per unit ▼</label>
                                <input type="number" class="form-control" id="unitPrice" placeholder="Price per kg, dozen, packet, etc." min="0.01" step="0.01" required>
                            </div>
                            <div class="mb-3">
                                <label for="purchasePrice" class="form-label">Enter purchase price per unit ▼</label>
                                <input type="number" class="form-control" id="purchasePrice" placeholder="Price per kg, dozen, packet, etc." min="0.01" step="0.01" required>
                            </div>
                            <button type="submit" class="btn btn-primary w-100">
                                <svg class="bi me-1"><use xlink:href="#bi-save"/></svg>Add Record
                            </button>
                        </form><br><br>
                        
                        <hr>
                        
                        <div class="d-flex justify-content-between">
                            <button id="clearRecordsBtn" class="btn btn-danger">
                                <svg class="bi me-1"><use xlink:href="#bi-trash"/></svg> Clear All
                            </button>
                            <button id="viewRecordsBtn" class="btn btn-warning">
                                <svg class="bi me-1"><use xlink:href="#bi-list"/></svg> View All
                            </button>
                        </div><br>
                    
                </div></div>
                
                
            </div><br>                 

                <!-- Summary Cards -->
                <div class="card summary-card border-start-primary">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-muted mb-2">Total Sales Amount</h6>
                                <h3 class="mb-0" id="totalSales">0 Rs</h3>
                            </div>
                            <div class="bg-primary-light p-3 rounded">
                                <svg class="bi text-primary fs-4"><use xlink:href="#bi-cart-check"/></svg>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card summary-card border-start-success">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-muted mb-2">Total Profit</h6>
                                <h3 class="mb-0" id="totalProfit">0 Rs</h3>
                            </div>
                            <div class="bg-success-light p-3 rounded">
                                <svg class="bi text-success fs-4"><use xlink:href="#bi-currency-rupee"/></svg>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card summary-card border-start-danger">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-muted mb-2">Total Purchase Amount</h6>
                                <h3 class="mb-0" id="totalPurchase">0 Rs</h3>
                            </div>
                            <div class="bg-danger-light p-3 rounded">
                                <svg class="bi text-danger fs-4"><use xlink:href="#bi-bag"/></svg>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card summary-card border-start-primary">
    <div class="card-body">
        <div class="d-flex justify-content-between align-items-center">
            <div>
                <h6 class="text-muted mb-2">Total Items Sold</h6>
                <h3 class="mb-0" id="totalRecordsCountCard">0</h3>
            </div>
            <div class="bg-primary-light p-3 rounded">
                <svg class="bi text-primary fs-4"><use xlink:href="#bi-box-seam"/></svg>
            </div>
        </div>
    </div>
</div>
            </div><br><br><br>
            <h4>(Note: Tap on each chart for details)</h4>
            <!-- Visualizations Column -->
            <div class="col-lg-8">
                <div class="card">
                    <div class="card-header bg-white d-flex justify-content-between align-items-center">
                        <h5 class="card-title mb-0">
                            <svg class="icon bi"><use xlink:href="#bi-bar-chart"/></svg>Daily Sales Chart
                        </h5>
                        <div class="btn-group btn-group-sm" role="group">
                            <button type="button" class="btn btn-outline-secondary active" data-chart-type="bar">Bar</button>
                            <button type="button" class="btn btn-outline-secondary" data-chart-type="line">Line</button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="salesChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header bg-white">
                                <h5 class="card-title mb-0">
                                    <svg class="icon bi"><use xlink:href="#bi-pie-chart"/></svg>Top 5 Selling Items
                            </h5>
                            </div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="topItemsChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header bg-white">
                                <h5 class="card-title mb-0">
                                    <svg class="icon bi"><use xlink:href="#bi-graph-up"/></svg>Daily Profit
                                 </h5>
                            </div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="profitChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header bg-white d-flex justify-content-between align-items-center">
                        <h5 class="card-title mb-0">
                            <svg class="icon bi"><use xlink:href="#bi-table"/></svg>Low Selling Items
                        </h5>
                    </div>
                    <div class="card-body p-0">
                        <div class="table-container">
                            <table class="table table-hover mb-0">
                                <thead>
                                    <tr>
                                        <th>Item Name</th>
                                        <th>Quantity</th>
                                        <th>Sales Amount</th>
                                        <th>Profit</th>
                                    </tr>
                                </thead>
                                <tbody id="lowSalesTable">
                                    <tr>
                                        <td colspan="4" class="text-center">No data available</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header bg-white">
                        <h5 class="card-title mb-0">
                            <svg class="icon bi"><use xlink:href="#bi-currency-exchange"/></svg>Purchase vs Sales Comparison
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="comparisonChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    
    
    <!-- All Records Modal -->
<div class="modal fade" id="recordsModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title">All Records</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="d-flex justify-content-between mb-3">
                    <button class="btn btn-danger" id="removeAllBtnModal">
                        <svg class="bi me-1"><use xlink:href="#bi-trash"/></svg>Delete All Records
                    </button>
                    <div class="text-muted">
                        Total Records: <span id="totalRecordsCount">0</span>
                    </div>
                </div>
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Item Name</th>
                                <th>Quantity</th>
                                <th>Selling Price/Unit</th>
                                <th>Purchase Price/Unit</th>
                                <th>Total Sales</th>
                                <th>Total Purchase</th>
                                <th>Profit</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="allRecordsTable">
                            <tr>
                                <td colspan="9" class="text-center">No records available</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

    <!-- jQuery (place jquery.min.js in /js folder) -->
    <script src="jquery-3.6.0.min.js"></script>
    <!-- Bootstrap JS (place bootstrap.bundle.min.js in /js folder) -->
    <script src="bootstrap.bundle.min.js"></script>
    
    <script>
        // Initialize data
        let records = JSON.parse(localStorage.getItem('groceryRecords')) || [];
        let charts = {
            salesChart: null,
            profitChart: null,
            topItemsChart: null,
            comparisonChart: null
        };
        
        // Initialize the app when DOM is fully loaded
        $(document).ready(function() {
            // Set today's date as default
            document.getElementById('date').valueAsDate = new Date();
            
            // Initialize charts with actual data
            updateCharts();
            updateSummary();
            populateLowSalesTable();
            populateAllRecordsTable();
            
            // Initialize event listeners
            initializeEventListeners();
            
            // Initialize Bootstrap modal
            const recordsModal = new bootstrap.Modal(document.getElementById('recordsModal'));
        });



        function initializeEventListeners() {
            // Form submission
            $('#recordForm').on('submit', function(e) {
                e.preventDefault();
                
                // Get form values
                const date = $('#date').val();
                const itemName = $('#itemName').val();
                const quantity = parseFloat($('#quantity').val());
                const unit = $('#unit').val();
                const unitPrice = parseFloat($('#unitPrice').val());
                const purchasePrice = parseFloat($('#purchasePrice').val());
                
                // Validate inputs
                if (!itemName || itemName.trim() === '') {
                    showAlert('Please enter item name', 'danger');
                    return;
                }
                
                if (isNaN(quantity) || quantity <= 0) {
                    showAlert('Please enter valid quantity', 'danger');
                    return;
                }
                
                if (isNaN(unitPrice) || unitPrice <= 0) {
                    showAlert('Please enter valid selling price', 'danger');
                    return;
                }
                
                if (isNaN(purchasePrice) || purchasePrice <= 0) {
                    showAlert('Please enter valid purchase price', 'danger');
                    return;
                }
                
                // Calculate derived values
                const totalSale = quantity * unitPrice;
                const totalPurchase = quantity * purchasePrice;
                const profit = totalSale - totalPurchase;
                
                // Create record object
                const record = {
                    date,
                    itemName,
                    quantity,
                    unit,
                    unitPrice,
                    purchasePrice,
                    totalSale,
                    totalPurchase,
                    profit
                };
                
                // Add to records
                records.push(record);
                
                // Save to localStorage
                localStorage.setItem('groceryRecords', JSON.stringify(records));
                
                // Update UI
                updateCharts();
                updateSummary();
                populateLowSalesTable();
                populateAllRecordsTable();
                
                // Show success alert
                showAlert('Record added successfully!', 'success');
                
                // Reset form
                this.reset();
                $('#date').val(new Date().toISOString().substr(0, 10));
            });
            
            // Clear records button
            $('#clearRecordsBtn').on('click', function() {
                if(confirm('Are you sure you want to clear all records? This action cannot be undone.')) {
                    // Clear records
                    records = [];
                    localStorage.removeItem('groceryRecords');
                    
                    // Update UI
                    updateCharts();
                    updateSummary();
                    populateLowSalesTable();
                    populateAllRecordsTable();
                    
                    showAlert('All records cleared successfully!', 'success');
                }
            });
            
            // View all records button
            $('#viewRecordsBtn').on('click', function() {
                $('#recordsModal').modal('show');
            });

            // Remove all records button in modal
            $('#removeAllBtnModal').on('click', function() {
                if (records.length === 0) {
                    showAlert('No records available.', 'info');
                    return;
                }
                
                if (confirm('Are you sure you want to delete all records? This action cannot be undone.')) {
                    records = [];
                    localStorage.removeItem('groceryRecords');
                    
                    // Update UI
                    updateCharts();
                    updateSummary();
                    populateLowSalesTable();
                    populateAllRecordsTable();
                    
                    showAlert('All records deleted successfully!', 'success');
                    
                    // Close the modal
                    $('#recordsModal').modal('hide');
                }
            });
            
            // Floating add button
            $('#floatingAddBtn').on('click', function() {
                $('html, body').animate({
                    scrollTop: $('#recordForm').offset().top
                }, 500);
            });
            
            // Close form button
            $('#closeFormBtn').on('click', function() {
                $('#recordForm')[0].reset();
            });
            
            // Chart type buttons
            $('[data-chart-type]').on('click', function() {
                $('[data-chart-type]').removeClass('active');
                $(this).addClass('active');
                updateCharts();
            });
            
            // Close modal when clicking outside
            $('#recordsModal').on('click', function(e) {
                if (e.target === this) {
                    $(this).modal('hide');
                }
            });
            
            // Use event delegation for delete buttons in the modal
            $(document).on('click', '.remove-btn', function() {
                const index = parseInt($(this).data('index'));
                deleteRecord(index);
            });
        }

        // Initialize or update all charts
        function updateCharts() {
            // Process data for charts
            const processedData = processData(records);
            
            // Destroy existing charts if they exist
            Object.values(charts).forEach(chart => {
                if (chart) chart.destroy();
            });
            
            // Get chart type for sales chart
            const salesChartType = $('[data-chart-type].active').data('chart-type');
            
            // Sales Chart with visible data
            const salesCtx = document.getElementById('salesChart').getContext('2d');
            charts.salesChart = new Chart(salesCtx, {
                type: salesChartType,
                data: {
                    labels: processedData.dates,
                    datasets: [{
                        label: 'Daily Sales',
                        data: processedData.sales,
                        backgroundColor: salesChartType === 'bar' ? '#4b6cb7' : 'rgba(75, 108, 183, 0.2)',
                        borderColor: '#4b6cb7',
                        borderWidth: salesChartType === 'bar' ? 1 : 2,
                        tension: 0.1,
                        fill: salesChartType === 'line'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return 'Rs ' + value.toLocaleString();
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            enabled: true,
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': Rs ' + context.raw.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });

            // Profit Chart with visible data
            const profitCtx = document.getElementById('profitChart').getContext('2d');
            charts.profitChart = new Chart(profitCtx, {
                type: 'line',
                data: {
                    labels: processedData.dates,
                    datasets: [{
                        label: 'Daily Profit',
                        data: processedData.profits,
                        backgroundColor: 'rgba(46, 204, 113, 0.2)',
                        borderColor: '#2ecc71',
                        borderWidth: 2,
                        tension: 0.1,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return 'Rs ' + value.toLocaleString();
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            enabled: true,
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': Rs ' + context.raw.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });

            // Top Items Chart with visible data
            const topItemsCtx = document.getElementById('topItemsChart').getContext('2d');
            charts.topItemsChart = new Chart(topItemsCtx, {
                type: 'pie',
                data: {
                    labels: processedData.topItems.map(item => item.name),
                    datasets: [{
                        data: processedData.topItems.map(item => item.value),
                        backgroundColor: [
                            '#4b6cb7', '#2ecc71', '#e74c3c', '#f39c12', '#9b59b6'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        },
                        tooltip: {
                            enabled: true,
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.raw || 0;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = Math.round((value / total) * 100);
                                    return `${label}: Rs ${value.toLocaleString()} (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });

            // Comparison Chart with visible data
            const comparisonCtx = document.getElementById('comparisonChart').getContext('2d');
            charts.comparisonChart = new Chart(comparisonCtx, {
                type: 'bar',
                data: {
                    labels: processedData.dates,
                    datasets: [
                        {
                            label: 'Sales',
                            data: processedData.sales,
                            backgroundColor: '#4b6cb7'
                        },
                        {
                            label: 'Purchase',
                            data: processedData.purchaseData,
                            backgroundColor: '#f39c12'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return 'Rs ' + value.toLocaleString();
                                }
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            enabled: true,
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': Rs ' + context.raw.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Process records for charts
        function processData(records) {
            if (records.length === 0) {
                return {
                    dates: [],
                    sales: [],
                    profits: [],
                    topItems: [],
                    lowSalesItems: [],
                    purchaseData: []
                };
            }
            
            // Group by date
            const dateMap = {};
            records.forEach(record => {
                if (!dateMap[record.date]) {
                    dateMap[record.date] = {
                        sales: 0,
                        profit: 0,
                        purchase: 0
                    };
                }
                
                dateMap[record.date].sales += record.totalSale;
                dateMap[record.date].profit += record.profit;
                dateMap[record.date].purchase += record.totalPurchase;
            });
            
            const dates = Object.keys(dateMap).sort();
            const sales = dates.map(date => dateMap[date].sales);
            const profits = dates.map(date => dateMap[date].profit);
            const purchaseData = dates.map(date => dateMap[date].purchase);
            
            // Group by item to get the most common unit for each item
            const itemUnits = {};
            records.forEach(record => {
                if (!itemUnits[record.itemName]) {
                    itemUnits[record.itemName] = {};
                }
                if (!itemUnits[record.itemName][record.unit]) {
                    itemUnits[record.itemName][record.unit] = 0;
                }
                itemUnits[record.itemName][record.unit] += record.quantity;
            });
            
            // Get the most used unit for each item
            const preferredUnits = {};
            for (const itemName in itemUnits) {
                let maxUnit = '';
                let maxCount = 0;
                for (const unit in itemUnits[itemName]) {
                    if (itemUnits[itemName][unit] > maxCount) {
                        maxCount = itemUnits[itemName][unit];
                        maxUnit = unit;
                    }
                }
                preferredUnits[itemName] = maxUnit;
            }
            
            // Group by item for sales data
            const itemMap = {};
            records.forEach(record => {
                if (!itemMap[record.itemName]) {
                    itemMap[record.itemName] = {
                        quantity: 0,
                        sale: 0,
                        profit: 0,
                        unit: preferredUnits[record.itemName] || record.unit
                    };
                }
                
                itemMap[record.itemName].quantity += record.quantity;
                itemMap[record.itemName].sale += record.totalSale;
                itemMap[record.itemName].profit += record.profit;
            });
            
            // Convert to array and sort
            let items = Object.keys(itemMap).map(itemName => ({
                name: itemName,
                quantity: itemMap[itemName].quantity,
                unit: itemMap[itemName].unit,
                sale: itemMap[itemName].sale,
                profit: itemMap[itemName].profit
            }));
            
            // Top items by sale
            const topItems = [...items].sort((a, b) => b.sale - a.sale).slice(0, 5);
            
            // Low sales items
            const lowSalesItems = [...items].sort((a, b) => a.sale - b.sale).slice(0, 5);
            
            return {
                dates,
                sales,
                profits,
                topItems: topItems.map(item => ({ name: item.name, value: item.sale })),
                lowSalesItems,
                purchaseData
            };
        }

        // Update summary statistics
function updateSummary() {
    const totalSales = records.reduce((sum, record) => sum + record.totalSale, 0);
    const totalProfit = records.reduce((sum, record) => sum + record.profit, 0);
    const totalPurchase = records.reduce((sum, record) => sum + record.totalPurchase, 0);
    const totalRecordsCount = records.length;

    $('#totalSales').text('Rs ' + totalSales.toLocaleString());
    $('#totalProfit').text('Rs ' + totalProfit.toLocaleString());
    $('#totalPurchase').text('Rs ' + totalPurchase.toLocaleString());
    $('#totalRecordsCountCard').text(totalRecordsCount.toLocaleString());
    $('#totalRecordsCount').text(totalRecordsCount.toLocaleString());
}

        // Populate low sales table
        function populateLowSalesTable() {
            const tableBody = $('#lowSalesTable');
            tableBody.empty();
            
            if (records.length === 0) {
                tableBody.append('<tr><td colspan="4" class="text-center">No data available</td></tr>');
                return;
            }
            
            const processedData = processData(records);
            const lowSalesItems = processedData.lowSalesItems;
            
            if (lowSalesItems.length === 0) {
                tableBody.append('<tr><td colspan="4" class="text-center">No data available</td></tr>');
                return;
            }
            
            lowSalesItems.forEach(item => {
                const row = `
                    <tr>
                        <td>${item.name}</td>
                        <td>${item.quantity.toLocaleString()} ${item.unit}</td>
                        <td>Rs ${item.sale.toLocaleString()}</td>
                        <td>Rs ${item.profit.toLocaleString()}</td>
                    </tr>
                `;
                tableBody.append(row);
            });
        }
        
        // Populate all records table
function populateAllRecordsTable() {
    const tableBody = $('#allRecordsTable');
    tableBody.empty();
    
    // Update total records count
    $('#totalRecordsCount').text(records.length);
    
    if (records.length === 0) {
        tableBody.append('<tr><td colspan="9" class="text-center">No records available</td></tr>');
        return;
    }
    
    // Create an array with original indices
    const recordsWithIndices = records.map((record, index) => ({ record, originalIndex: index }));
    
    // Sort by date descending
    const sortedRecords = [...recordsWithIndices].sort((a, b) => new Date(b.record.date) - new Date(a.record.date));
    
    sortedRecords.forEach(({ record, originalIndex }) => {
        const row = `
            <tr>
                <td>${record.date}</td>
                <td>${record.itemName}</td>
                <td>${record.quantity} ${record.unit}</td>
                <td>Rs ${record.unitPrice.toLocaleString()}</td>
                <td>Rs ${record.purchasePrice.toLocaleString()}</td>
                <td>Rs ${record.totalSale.toLocaleString()}</td>
                <td>Rs ${record.totalPurchase.toLocaleString()}</td>
                <td>Rs ${record.profit.toLocaleString()}</td>
                <td>
                    <button class="btn btn-sm btn-danger remove-btn" data-index="${originalIndex}">
                        <svg class="bi"><use xlink:href="#bi-trash"/></svg>
                    </button>
                </td>
            </tr>
        `;
        tableBody.append(row);
    });
}
        
        // Delete a single record
        function deleteRecord(index) {
            if (confirm('Are you sure you want to delete this record?')) {
                records.splice(index, 1);
                localStorage.setItem('groceryRecords', JSON.stringify(records));
                
                // Update UI
                updateCharts();
                updateSummary();
                populateLowSalesTable();
                populateAllRecordsTable();
                
                showAlert('Record deleted successfully!', 'success');
                
                // If modal is open, refresh its content
                if ($('#recordsModal').hasClass('show')) {
                    populateAllRecordsTable();
                }
            }
        }

        // Show alert message
        function showAlert(message, type) {
            const alert = $(`
                <div class="alert alert-${type} alert-dismissible fade show" role="alert">
                    <svg class="bi me-2"><use xlink:href="#${getAlertIcon(type)}"/></svg> ${message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            `);
            
            // Clear previous alerts
            $('#alertSection').empty().append(alert);
            
            // Auto dismiss after 5 seconds
            setTimeout(() => {
                alert.alert('close');
            }, 5000);
        }
        
        function getAlertIcon(type) {
            switch(type) {
                case 'success': return 'bi-check-circle';
                case 'danger': return 'bi-exclamation-triangle';
                case 'warning': return 'bi-exclamation-circle';
                case 'info': return 'bi-info-circle';
                default: return '';
            }
        }
    </script>
</body>
</html>
